<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brunos Website — IP & Ort</title>
  <style>
    /* (Dein bestehendes Styling — leicht verkürzt/angepasst für Fokus) */
    body{
      margin:0; padding:0; min-height:100vh;
      background-image: url('https://images.pexels.com/photos/1366957/pexels-photo-1366957.jpeg?cs=srgb&dl=pexels-iriser-1366957.jpg&fm=jpg');
      background-size:cover; background-position:center; color:white;
      font-family: Arial, sans-serif;
      display: flex; flex-direction: column; align-items: center;
      padding: 30px 20px 80px 20px;
    }
    #info{
      margin-top:30px; text-align:center; font-size:18px;
      background: rgba(0,0,0,0.55); padding:14px; border-radius:10px;
      max-width:720px; width:100%;
    }
    .label { opacity:0.85; font-size:14px; margin-top:6px; }
    .value { font-weight:700; font-family: "Ubuntu Mono", monospace; font-size:18px; }
    .small { font-size:13px; opacity:0.8; margin-top:6px; }
  </style>
</head>
<body>

  <h1 style="margin-top:10px; font-family:'Ubuntu Mono', monospace;">Welcome to my Website</h1>

  <p style="max-width:800px; text-align:center; font-family:'Ubuntu Mono', monospace;">
    Auf dieser Seite findest du Informationen zu meiner Umschulung. Hier zeigen wir zusätzlich die IP-Adresse
    und den vermuteten Standort (Geo-IP).
  </p>

  <div id="info">
    <div class="label">Browser / Betriebssystem</div>
    <div id="ua" class="value">Wird ermittelt…</div>

    <div class="label">IP-Adresse</div>
    <div id="ip" class="value">Wird geladen…</div>

    <div class="label">Vermuteter Ort</div>
    <div id="location" class="value">Wird geladen…</div>

    <div id="coords" class="small"></div>

    <div id="note" class="small" style="margin-top:12px; opacity:0.9;">
      Hinweis: IP &amp; Standort werden live von einem externen Geo-IP-Dienst abgefragt. Das sind personenbezogene Daten.
      Wenn die Seite öffentlich ist, bitte Datenschutzerklärung beachten.
    </div>
  </div>

  <script>
    // --- Funktion: Browser/OS aus userAgent (einfacher Parser) ---
    function parseUA(){
      const ua = navigator.userAgent || "";
      const browser = ua.includes("Firefox") ? "Firefox" :
                      ua.includes("Edg/") ? "Edge" :
                      ua.includes("Chrome") && !ua.includes("Edg/") ? "Chrome" :
                      ua.includes("Safari") && !ua.includes("Chrome") ? "Safari" :
                      "Unbekannt";
      const version = (ua.match(/(Firefox|Edg|Chrome)\/([\d.]+)/) || [])[2] ||
                      (ua.match(/Version\/([\d.]+).*Safari/) || [])[1] || "";
      let os = "Unbekannt", osversion = "";
      if (/Windows NT/.test(ua)) { os="Windows"; osversion = (ua.match(/Windows NT ([\d.]+)/)||[])[1] || ""; }
      else if (/Mac OS X/.test(ua)) { os="macOS"; osversion = (ua.match(/Mac OS X ([\d_]+)/)||[])[1]?.replaceAll("_",".") || ""; }
      else if (/Android/.test(ua)) { os="Android"; osversion = (ua.match(/Android ([\d.]+)/)||[])[1] || ""; }
      else if (/iPhone|iPad|iPod/.test(ua)) { os="iOS"; }
      return { browser, version, os, osversion };
    }

    // UI-Elemente
    const uaEl = document.getElementById('ua');
    const ipEl = document.getElementById('ip');
    const locationEl = document.getElementById('location');
    const coordsEl = document.getElementById('coords');

    // Browser/OS sofort anzeigen
    const ui = parseUA();
    uaEl.textContent = `${ui.browser} ${ui.version} (${ui.os} ${ui.osversion})`;

    // --- IP + Geo laden (automatisch beim Laden) ---
    (async function loadIpAndGeo(){
      try {
        // 1) IP + Geo in einem Request: ipapi.co/json liefert beides
        // Alternativen: ipinfo.io (token), ipgeolocation.io (token), ipapi.co (kostenlos für einfache Nutzung)
        const r = await fetch('https://ipapi.co/json/');
        if (!r.ok) throw new Error('HTTP ' + r.status);
        const data = await r.json();

        // ipapi.co gibt Felder wie: ip, city, region, country_name, latitude, longitude, postal
        const ip = data.ip || 'unbekannt';
        const city = data.city || '';
        const region = data.region || '';
        const country = data.country_name || data.country || '';
        const latitude = data.latitude ?? data.lat ?? '';
        const longitude = data.longitude ?? data.lon ?? '';
        const postal = data.postal || '';

        ipEl.textContent = ip;
        // Ort zusammensetzen — nur nichtleere Teile verwenden
        const parts = [];
        if (city) parts.push(city);
        if (region && region !== city) parts.push(region);
        if (postal && !parts.includes(postal)) parts.push(postal);
        if (country) parts.push(country);
        const locText = parts.length ? parts.join(', ') : 'Nicht verfügbar';
        locationEl.textContent = locText;

        if (latitude && longitude) {
          coordsEl.textContent = `Koordinaten: ${latitude}, ${longitude}`;
        } else {
          coordsEl.textContent = '';
        }
      } catch (e) {
        console.error('Fehler beim Laden der Geo-IP:', e);
        ipEl.textContent = 'konnte nicht geladen werden';
        locationEl.textContent = 'konnte nicht geladen werden';
        coordsEl.textContent = '';
      }
    })();
  </script>

</body>
</html>
